<!-- owner.html -->
<!-- Tambahkan ini di dalam adminPanel setelah form tambah produk -->
<div class="order-management">
    <h2>Manajemen Order</h2>
    <div class="order-list" id="orderList"></div>
</div>

<script>
    // ... Kode sebelumnya ...

    function loadOrders() {
        const orders = JSON.parse(localStorage.getItem('orders')) || [];
        const orderList = document.getElementById('orderList');
        orderList.innerHTML = '';
        
        orders.forEach(order => {
            orderList.innerHTML += `
                <div class="order-item status-${order.status}">
                    <div class="order-header">
                        <span>#${order.id}</span>
                        <span>${new Date(order.timestamp).toLocaleString()}</span>
                    </div>
                    <div class="order-body">
                        <p>DANA: ${order.danaNumber}</p>
                        <img src="${order.paymentProof}" 
                             class="proof-img" 
                             onclick="showProof('${order.paymentProof}')">
                        <div class="order-actions">
                            <button onclick="approveOrder('${order.id}')">
                                <i class="fas fa-check"></i> Approve
                            </button>
                            <button class="reject" onclick="rejectOrder('${order.id}')">
                                <i class="fas fa-times"></i> Reject
                            </button>
                            <input type="file" 
                                   id="file${order.id}" 
                                   class="file-input" 
                                   onchange="uploadFile('${order.id}', this)">
                        </div>
                    </div>
                </div>
            `;
        });
    }

    function showProof(imgSrc) {
        const w = window.open('', 'Bukti Transfer');
        w.document.write(`<img src="${imgSrc}" style="max-width:100%">`);
    }

    function approveOrder(orderId) {
        const orders = JSON.parse(localStorage.getItem('orders'));
        const orderIndex = orders.findIndex(o => o.id === orderId);
        
        const fileInput = document.getElementById(`file${orderId}`);
        if(fileInput.files.length > 0) {
            const reader = new FileReader();
            reader.onload = function(e) {
                orders[orderIndex].downloadLink = e.target.result;
                orders[orderIndex].status = 'approved';
                localStorage.setItem('orders', JSON.stringify(orders));
                loadOrders();
            };
            reader.readAsDataURL(fileInput.files[0]);
        }
    }

    function rejectOrder(orderId) {
        const orders = JSON.parse(localStorage.getItem('orders'));
        const orderIndex = orders.findIndex(o => o.id === orderId);
        orders[orderIndex].status = 'rejected';
        localStorage.setItem('orders', JSON.stringify(orders));
        loadOrders();
    }

    function uploadFile(orderId, input) {
        // Handle file upload logic
    }

    // Panggil loadOrders() setelah login
</script>
